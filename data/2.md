# Лекция 2: Цифрови алгоритми – описание в честотна област. Цифрова филтрация – основни понятия

**Преподавател:** доц. д-р Златка Вълкова-Джарвис

---

## СЪДЪРЖАНИЕ

1. Цифрови системи – описание в честотна област
2. Същност на цифровата филтрация
3. Сравнение на аналогови и цифрови филтри
4. Аналитично описание на цифрови филтри. Видове, сравнение
5. Проектиране на цифрови филтри – етапи, цифрови габарити на АЧХ и затихването

---

## 1. ЦИФРОВИ СИСТЕМИ – ОПИСАНИЕ В ЧЕСТОТНА ОБЛАСТ

### Връзка между z-област и честотна област

**Преобразувание:** $z = e^{j\omega T}$

**Основни параметри:**

- Честота на дискретизация: $f_d = 1/T_d$ [Hz]
- Период на дискретизация: $T_d$ [sec]
- Кръгова честота: $\omega = 2\pi f$ [rad/s]

### Предавателна функция в честотен вид

$$H(z)|_{z=e^{j\omega T}} = H(e^{j\omega T})$$

**Комплексна форма:**
$$H(e^{j\omega T}) = H_{Re}(\omega) + jH_{Im}(\omega)$$

### Амплитудно-Честотна Характеристика (АЧХ)

$$|H(e^{j\omega T})| = \sqrt{H_{Re}^2(\omega) + H_{Im}^2(\omega)}$$

### Фазово-Честотна Характеристика (ФЧХ)

$$\theta(\omega) = \arg[H(e^{j\omega T})] = \arctg\frac{H_{Im}(\omega)}{H_{Re}(\omega)}$$

**Експоненциална форма:**
$$H(e^{j\omega T}) = |H(e^{j\omega T})|e^{j\theta(\omega)}$$

### Свойства на честотните характеристики

- **Теоретични честоти:** $[-\omega_d, \omega_d]$
- **Реални честоти:** $[0, \omega_d/2]$
- АЧХ е **четна** функция: $H(\omega) = H(-\omega)$
- ФЧХ е **нечетна** функция: $\theta(\omega) = -\theta(-\omega)$

### Влияние на полюсите и нулите

- **За честоти близки до нулите:** АЧХ **спада**
- **За честоти близки до полюсите:** АЧХ **нараства**

### Логаритмична АЧХ (ЛАЧХ)

$$H_{\log}(\omega) = 20\lg|H(e^{j\omega T})|, \text{ dB}$$

### Затихване

$$a(\omega) = -20\lg|H(e^{j\omega T})|, \text{ dB}$$

### Групово Време на Закъснение (ГВЗ)

$$t_{gd}(\omega) = -\frac{d\theta(\omega)}{d\omega}$$

---

## 2. СЪЩНОСТ НА ЦИФРОВАТА ФИЛТРАЦИЯ

### Дефиниция

**Електрически филтър** - селективна верига, която пропуска определени честоти с нулево или малко затихване и не пропуска други честоти с безкрайно или голямо затихване.

**Цифров филтър** - изчислителен алгоритъм, по който дадена входна числена последователност се преобразува в изходна последователност с желани свойства.

### Класификация на електрическите филтри

```
ЕЛЕКТРИЧЕСКИ ФИЛТРИ
├── АНАЛОГОВИ ФИЛТРИ
│   ├── Пасивни
│   └── Активни
└── ЦИФРОВИ ФИЛТРИ
    ├── Нерекурсивни (КИХ/FIR)
    └── Рекурсивни (БИХ/IIR)
```

### Основни функции на цифровите филтри

- Усилване на определени честотни диапазони
- Потискане на шумови сигнали
- Отделяне на честотни ленти
- Отстраняване на определени честоти
- Специфични обработки:
  - Интегриране
  - Диференциране
  - Хилбертова трансформация

---

## 3. СРАВНЕНИЕ НА АНАЛОГОВИ И ЦИФРОВИ ФИЛТРИ

| Характеристика              | Аналогови филтри    | Цифрови филтри          |
| --------------------------- | ------------------- | ----------------------- |
| **Реализация**              | Аналогови вериги    | Цифров хардуер/софтуер  |
| **Чувствителност към шум**  | Висока              | Ниска (само квантуване) |
| **Динамичен диапазон**      | Ограничен           | Може да е безкраен      |
| **Точност**                 | Ограничен толеранс  | Висока точност          |
| **Повторяемост**            | Не добра            | Отлична                 |
| **Устойчивост**             | Не добра            | Отлична                 |
| **Гъвкавост**               | Ограничена          | Максимална              |
| **Честотен диапазон**       | Теоретично безкраен | Ограничен до $f_d/2$    |
| **Фазови изкривявания**     | Нелинейна ФЧХ       | Линейна ФЧХ (FIR)       |
| **Проектиране**             | Трудно              | Лесно                   |
| **Допълнителни компоненти** | Не изисква          | АЦП, ЦАП                |

---

## 4. АНАЛИТИЧНО ОПИСАНИЕ НА ЦИФРОВИ ФИЛТРИ

### Описание в различни области

**Времева област:**

- Нерекурсивно: $y(n) = \sum_{i=0}^{M} h_i x(n-i)$
- Рекурсивно: $y(n) = \sum_{i=0}^{M} b_i x(n-i) - \sum_{k=1}^{N} a_k y(n-k)$

**Z-област:**

- Нерекурсивна: $H(z) = h_0 + h_1z^{-1} + \ldots + h_Mz^{-M}$
- Рекурсивна: $H(z) = \frac{b_0 + b_1z^{-1} + \ldots + b_Mz^{-M}}{1 + a_1z^{-1} + \ldots + a_Nz^{-N}}$

**Честотна област:**

- Импулсна характеристика h(n)
- Преходна характеристика g(n)
- ПНД (полюсно-нулева диаграма)
- АЧХ, ФЧХ, затихване

### Нормирана честота

$$\Omega = \frac{\omega}{\omega_d/2} = \frac{2\omega}{\omega_d}$$

$$F = \frac{f}{f_d/2} = \frac{2f}{f_d}$$

Диапазон: $\Omega \in [0, \pi]$ или $F \in [0, 1]$

### Сравнение КИХ vs БИХ филтри

**НЕРЕКУРСИВНИ (КИХ) - Предимства:**

- Могат да имат линейна ФЧХ
- Априори устойчиви
- Грешките не са проблем
- Лесни за проектиране
- Може да се използва DFT

**НЕРЕКУРСИВНИ - Недостатъци:**

- По-висок ред на ПФ
- По-висока изчислителна сложност
- Не могат от аналого-цифрово преобразуване

**РЕКУРСИВНИ (БИХ) - Предимства:**

- По-качествени честотни характеристики
- Класически апроксимации
- По-нисък ред
- От аналого-цифрово преобразуване

**РЕКУРСИВНИ - Недостатъци:**

- Нелинейна ФЧХ
- Могат да бъдат неустойчиви
- Паразитни ефекти от квантуване

### Пример за сравнение на редовете

**НЧФ с $f_{pass}=475$ Hz, $f_{stop}=525$ Hz, $f_s=2000$ Hz:**

- **FIR филтър:** N = 78
- **IIR филтър (елиптичен):** N = 7

---

## 5. ПРОЕКТИРАНЕ НА ЦИФРОВИ ФИЛТРИ

### Етапи при проектиране

1. **Определяне на габарит (спецификация)** - според приложението
2. **Апроксимация** - математически подходи за аналитично описание
3. **Синтез и реализация** - хардуерна или софтуерна

### Типове честотно-селективни филтри

- **НЧФ** - Нискочестотен филтър
- **ВЧФ** - Високочестотен филтър
- **ЛФ** - Лентов филтър
- **РФ** - Режекторен филтър

### Габарит на цифров филтър

**Габарит** - шаблон, който определя каква трябва да бъде кривата на АЧХ или затихването.

**Идеален НЧФ:**
$$h(n) = \frac{\sin(\omega_s n)}{\pi n}$$

**Проблеми:**

- Не е каузален (h(n) ≠ 0 за n < 0)
- H(ω) не може да е константа в никоя лента

### Области на филтъра

- **ЛП** - Лента на пропускане
- **ЛЗ** - Лента на задържане
- **ПО** - Преходна област

### Параметри на габарита (НЧФ)

**Честоти:**

- $\omega_d$ - честота на дискретизация
- $\omega_p$ - гранична честота
- $\omega_s$ - честота на задържане

**АЧХ параметри:**

- $\delta_p$ - максимални отскоци в ЛП
- $\delta_s$ - максимални отскоци в ЛЗ

**ЛАЧХ параметри:**

- $H_{min}$ - минимална амплитуда
- $H_{max}$ - максимална амплитуда

**Затихване:**

- $a_{max}$ - максимално затихване в ЛП
- $a_{min}$ - минимално затихване в ЛЗ

### Връзки между параметрите

$$a_{max} = -H_{min} = -20\lg(1-\delta_p) \text{ dB}$$

$$a_{min} = -H_{max} = -20\lg(\delta_s) \text{ dB}$$

---

## ОСНОВНИ ТЕРМИНИ

- **АЧХ** - Амплитудно-честотна характеристика
- **ФЧХ** - Фазово-честотна характеристика
- **ЛАЧХ** - Логаритмична АЧХ
- **ГВЗ** - Групово време на закъснение
- **НЧФ** - Нискочестотен филтър
- **ВЧФ** - Високочестотен филтър
- **ЛФ** - Лентов филтър
- **РФ** - Режекторен филтър

---
### Въпрос 1
Какво представлява преобразуването от z-област в честотна област?

A. $z = e^{j\omega T}$
B. $z = \omega e^{jT}$
C. $z = j\omega e^{-T}$
D. $z = T e^{j\omega}$
Correct: A

### Въпрос 2
Коя формула описва Амплитудно-честотната характеристика (АЧХ)?

A. $|H(e^{j\omega T})| = \sqrt{H_{Re}^2(\omega) + H_{Im}^2(\omega)}$
B. $H(e^{j\omega T}) = H_{Re}(\omega) + jH_{Im}(\omega)$
C. $\theta(\omega) = \arg[H(e^{j\omega T})]$
D. $t_{gd}(\omega) = -\frac{d\theta(\omega)}{d\omega}$
Correct: A

### Въпрос 3
Кой от следните изрази определя груповото време на закъснение?

A. $t_{gd}(\omega) = -\frac{d\theta(\omega)}{d\omega}$
B. $t_{gd}(\omega) = \frac{d|H(\omega)|}{d\omega}$
C. $t_{gd}(\omega) = \int\theta(\omega) d\omega$
D. $t_{gd}(\omega) = -\frac{d|H(\omega)|}{d\omega}$
Correct: A

### Въпрос 4
Какво е основното предимство на цифровите филтри спрямо аналоговите? (Select all that apply)

A. По-висока точност и повторяемост
B. Линейна фазова характеристика (за КИХ)
C. По-голяма гъвкавост и програмируемост
D. Не изискват АЦП и ЦАП
Correct: A, B, C

### Въпрос 5
Кой от следните фактори ограничава честотния диапазон на цифровите филтри?

A. Теоремата на Найквист (ограничение до $f_d/2$)
B. Мощността на изчислителното устройство
C. Качеството на компонентите
D. Нивото на шума
Correct: A

### Въпрос 6
Каква е разликата между логаритмична АЧХ и затихване?

A. Затихването е отрицателната стойност на ЛАЧХ
B. ЛАЧХ е в децибели, затихването е в волта
C. ЛАЧХ измерва усилване, затихването измерва отслабване
D. Няма разлика между двете
Correct: A

### Въпрос 7
Как се изчислява нормираната честота?

A. $F = \frac{f}{f_d/2} = \frac{2f}{f_d}$
B. $F = \frac{f_d}{2f}$
C. $F = f \cdot f_d/2$
D. $F = \frac{f_d}{f}$
Correct: A

### Въпрос 8
Кой филтър изисква значително по-висок ред за същите спецификации?

A. КИХ (FIR) филтър
B. БИХ (IIR) филтър
C. Елиптичен филтър
D. Чебишов филтър
Correct: A

### Въпрос 9
Какво представлява цифровият филтър?

A. Изчислителен алгоритъм за преобразуване на входна числова последователност в изходна
B. Аналогова верига с цифрови компоненти
C. Устройство за преобразуване на аналогови сигнали в цифрови
D. Вид усилвател с цифрова регулация
Correct: A

### Въпрос 10
Кои са основните етапи при проектиране на цифрови филтри? (Select all that apply)

A. Определяне на габарит (спецификация)
B. Апроксимация
C. Синтез и реализация
D. Калибриране
Correct: A, B, C

### Въпрос 11
Какво се случва с АЧХ при честоти близки до полюсите на предавателната функция?

A. АЧХ нараства
B. АЧХ спада
C. АЧХ остава постоянна
D. АЧХ става нелинейна
Correct: A

### Въпрос 12
Кой от следните филтри винаги е устойчив?

A. КИХ филтър
B. БИХ филтър
C. Рекурсивен филтър
D. Филтър с обратна връзка
Correct: A

### Въпрос 13
Каква е основната характеристика на фазово-честотната характеристика (ФЧХ)?

A. Нечетна функция: $\theta(\omega) = -\theta(-\omega)$
B. Четна функция: $\theta(\omega) = \theta(-\omega)$
C. Периодична функция с период $2\pi$
D. Винаги положителна функция
Correct: A

### Въпрос 14
Кой от следните методи се използва за апроксимация на БИХ филтри?

A. Билинейно z-преобразуване
B. Метод с прозоречни функции
C. Метод с дискретизация на АЧХ
D. Метод с минимизиране на квадратична грешка
Correct: A

### Въпрос 15
Какво представлява елиптичният филтър?

A. БИХ филтър с оптимална честотна характеристика
B. КИХ филтър с линейна фаза
C. Аналогов филтър с постоянна АЧХ
D. Цифров филтър за премахване на шум
Correct: A

### Въпрос 16
Кога цифровият филтър се нарича нискочестотен (НЧФ)?

A. Когато пропуска ниски честоти и задържа високи
B. Когато пропуска високи честоти и задържа ниски
C. Когато пропуска само определена честотна лента
D. Когато задържа всички честоти
Correct: A

### Въпрос 17
Какво е основното предимство на линейната фазова характеристика?

A. Запазва формата на сигнала при филтриране
B. Осигурява по-добро затихване
C. Намалява изчислителната сложност
D. Повишава стабилността на системата
Correct: A

### Въпрос 18
Кой от следните параметри НЕ се влияе от квантуването в цифровите филтри?

A. Честотата на дискретизация
B. Коефициентите на филтъра
C. Изчислителната точност
D. Изходният сигнал
Correct: A

### Въпрос 19
Какво представлява режекторният филтър?

A. Филтър, който премахва определена честота или честотна лента
B. Филтър, който пропуска само определена честотна лента
C. Филтър, който пропуска всички честоти под определена граница
D. Филтър, който пропуска всички честоти над определена граница
Correct: A

### Въпрос 20
Кои са основните функции на цифровите филтри? (Select all that apply)

A. Усилване на определени честотни диапазони
B. Потискане на шумови сигнали
C. Отделяне на честотни ленти
D. Интегриране и диференциране
Correct: A, B, C, D
---
